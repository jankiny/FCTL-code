# FCTL-code

## Introduction
The code will be sorted and published soon.

## Getting started

### 1. Installation

FCTL is developed based on `torch==1.13.0` `torchvision==0.14.0` `pytorch-lightning==2.2.1`

### 2. Preparing Data

We provide the detail about the benchmark datasets in [data/]().

## Evaluation

| Dataset      | Backbone  | AUROC | Log                                                                                              | Weight ([Backup](https://pan.baidu.com/s/1zVZoFfD2D40MXZL4G5z7Ow?pwd=fctl))                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|--------------|-----------|-------|--------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| MNIST        | ResNet101 | 0.999 |                                                                                                  | ðŸ¤—[split1](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_cnnr101_MNIST_split1_2_exp.ckpt) [split2](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_cnnr101_MNIST_split2_2_exp.ckpt) [split3](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_cnnr101_MNIST_split3_2_exp.ckpt) [split4](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_cnnr101_MNIST_split4_2_exp.ckpt) [split5](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_cnnr101_MNIST_split5_2_exp.ckpt)                           |
| SVHN         | ResNet101 | 0.972 |                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| CIFAR10      | ResNet101 | 0.948 |                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| CIFAR+10     | ResNet101 | 0.990 |                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| CIFAR+50     | ResNet101 | 0.979 |                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| TinyImageNet | ResNet101 | 0.951 |                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| CUB          | ResNet101 | 0.812 | [split1_log](https://drive.google.com/file/d/1Eyutt5cf0V_o7S0T_6AKPWVV7n9D-0Jx/view?usp=sharing)                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Aircraft     | ResNet101 | 0.853 | [split1_log](https://drive.google.com/file/d/12apkcoi-YQRP5IK9MVBQ_r-zFw6byLyE/view?usp=sharing) | ðŸ¤—[split1](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_cnnr101_FGVC_split1_2_exp.ckpt)                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| MNIST        | ViT/B16   | 0.983 | [split1_log](https://drive.google.com/file/d/1NgXw2nWYuOaGUs527_TP_RdQES7ZYawD/view?usp=sharing) |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| SVHN         | ViT/B16   | 0.974 |                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| CIFAR10      | ViT/B16   | 0.987 |                                                                                                  | ðŸ¤—[split1](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10_split1_2_exp.ckpt) [split2](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10_split2_2_exp.ckpt) [split3](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10_split3_2_exp.ckpt) [split4](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10_split4_2_exp.ckpt) [split5](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10_split5_2_exp.ckpt)                          |
| CIFAR+10     | ViT/B16   | 0.995 |                                                                                                  | ðŸ¤—[split1](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B10_split1_2_exp.ckpt) [split2](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B10_split2_2_exp.ckpt) [split3](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B10_split3_2_exp.ckpt) [split4](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B10_split4_2_exp.ckpt) [split5](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B10_split5_2_exp.ckpt) |
| CIFAR+50     | ViT/B16   | 0.991 |                                                                                                  | ðŸ¤—[split1](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B50_split1_2_exp.ckpt) [split2](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B50_split2_2_exp.ckpt) [split3](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B50_split3_2_exp.ckpt) [split4](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B50_split4_2_exp.ckpt) [split5](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CIFAR10%2B50_split5_2_exp.ckpt) |
| TinyImageNet | ViT/B16   | 0.978 |                                                                                                  | ðŸ¤—[split1](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_TinyImageNet_split1_2_exp.ckpt) [split2](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_TinyImageNet_split2_2_exp.ckpt) [split3](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_TinyImageNet_split3_2_exp.ckpt) [split4](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_TinyImageNet_split4_2_exp.ckpt) [split5](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_TinyImageNet_split5_2_exp.ckpt) |
| CUB          | ViT/B16   | 0.895 |                                                                                                  | ðŸ¤—[split1](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_vitb16_CUB_split1_2_exp.ckpt)                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Aircraft     | ViT/B16   | 0.817 | [split1_log](https://drive.google.com/file/d/1NMHx4idPxVt_mLxzlmyNeuJO8Whb_wRs/view?usp=sharing) |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| CIFAR10-ood  | ResNet101 |       |                                                                                                  | ðŸ¤—[split1](https://huggingface.co/Jankiny/FCTL-report/blob/main/common_cnnr101_CIFAR10%2Bood_split1_2_exp.ckpt)                                                                                                                                                                                                                                                                                                                                                                                                                               |

https://drive.google.com/file/d/12apkcoi-YQRP5IK9MVBQ_r-zFw6byLyE/view?usp=drive_link

```bash
chmod +x _scripts/*/test*.sh
```

## Training

The code will be sorted and published soon.

